
import requests
import json

# Zammad instance details
zammad_url = "http://172.24.57.66:8080/api/v1/tickets"
token = "35TodJTtbKLpCZfzW3_48FF3pEWh-ZK6mAGHk03s3InL8oh8bkmdc9rGarx0s1Jp"  # Replace with your actual user token

# Ticket data
ticket_data = {
    "title": "Ashish test api",
    "group_id": 1,  # Replace with your desired group ID (e.g., 1 for Users)
    "customer_id": 2, # Replace with your desired customer ID.
    "article": {
        "subject": "Test Ticket Article",
        "body": "This is a test ticket created via the Zammad API by python.",
        "mime_type": "text/plain",
        "internal": False, # Set to true if the article should be internal.
    },
    "state_id": 1, #Replace with your desired state id (e.g., 1 for new)
    "priority_id": 2, #Replace with your desired priority id. (e.g., 2 for normal)
}

# Headers for authentication
headers = {
    "Authorization": f"Token token={token}",
    "Content-Type": "application/json",
}

try:
    response = requests.post(zammad_url, headers=headers, data=json.dumps(ticket_data))
    response.raise_for_status()  # Raise HTTPError for bad responses (4xx or 5xx)

    print("Ticket created successfully!")
    print("Response:", response.json())

except requests.exceptions.RequestException as e:
    print(f"Error: {e}")
    if response is not None:
        print("Response Content:", response.text) #Print the error response from zammad.
except json.JSONDecodeError as e:
    print(f"Error decoding JSON response: {e}")

